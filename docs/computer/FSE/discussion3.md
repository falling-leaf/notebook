# discussion 3/2024.5.6

## 数据结构

- 账户（与模块2、3保持一致）（此处合并了银行卡与存折）
  - 账户ID（银行卡号/存折号）
  - 账户密码（支付密码）
  - 账户所有者身份证号
  - 余额（具体计算方式需要统一）
  - 活期存款
  - 待定存款（活期存款+待定存款=余额）
  - （可能需要的，所有者的其他身份认证信息，如联系方式）
  - 是否冻结（冻结为：该卡暂时作废，直至解冻）
  - 是否挂失（挂失为：该卡作废，在创建新卡前仍然保留，创建新卡将余额转入新卡并销毁该卡）

- 出纳员
  - 账号名
  - 密码
  - 出纳员权限
    - 开设账户
    - 对帐户进行服务（存款/取款/挂失/补发/冻结/解冻/续期）

- 管理员
  - 账号名
  - 密码

- 存款交易记录
  - 存款交易ID
  - 存款账号
  - 存款类型
  - 存款是否自动续期（活期存款默认为null）
  - 利率
  - 存款起始日期
  - 存款终止日期（活期默认为null）
  - 存款金额
  - 出纳员ID

- 取款交易记录
  - 取款交易ID
  - 取款账号
  - 取款金额
  - 取款时间
  - 出纳员ID

- 转账交易记录
  - 转账交易ID
  - 转出账号
  - 转入账号
  - 转账金额
  - 转账时间
  - 出纳员ID

## 余额计算方式

### 存款：

- 活期存款：

1. 对活期存款采用月结的方式
2. 人为约定活期存款的利率始终为一常数
3. 每个账户存在“待定存款”与“活期存款”，每月1号所有待定存款将被转入活期存款中
4. 每月1号对活期存款进行利息计算与复利操作

举例：

A在1月15日存入3000元，假设利率恒为0.3%:此时3000元为A的**待定存款**，不计入活期存款；

活期存款：0元

待定存款：3000元

在2月1日：A账户余额总额为3000元，此时3000元为A的**活期存款**。

活期存款：3000元

待定存款：0元

在2月15日：A账户存入1500元，此时：余额总额为4500元

活期存款：3000元

待定存款：1500元

在3月1日：A账户余额总额为4509元（4500 + 3000 \* 0.3%）；

活期存款：4509元

待定存款：0元

- 定期存款：

1. 定期存款存在不同的方案，对应不同的存款期限和利率
2. 定期存款不可以被用户取出
3. 在定期存款到期后，计算定期存款的利率，判定本次交易“已办结”，之后分两种情况：
   1. 没有“自动续期”：对定期存款及利息存入**待定存款**中
   2. 有“自动续期”：将定期存款及利息再次进行同年份的**定期存款**

### 取款：

取款将：优先取待定存款，之后取活期存款，应当有：$取款金额 \leq 待定存款+活期存款$

### 转账:

转账相当于取款+活期存款